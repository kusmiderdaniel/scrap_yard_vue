{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport axios from 'axios';\nimport { toast } from 'bulma-toast';\nexport default {\n  name: 'ItemStatistics',\n  data() {\n    return {\n      dateFrom: '',\n      dateTo: '',\n      receipt_items: [],\n      unique_items: []\n    };\n  },\n  mounted() {\n    this.getReceiptItems(), this.setWeekRange();\n  },\n  methods: {\n    getReceiptItems() {\n      axios.get('/api/v1/receipts/').then(response => {\n        console.log(response);\n        for (let i = 0; i < response.data.length; i++) {\n          if (response.data[i].date >= this.dateFrom && response.data[i].date <= this.dateTo) {\n            for (let x = 0; x < response.data[i].receipt_items.length; x++) {\n              this.receipt_items.push(response.data[i].receipt_items[x]);\n            }\n          }\n        }\n        this.calculateItems();\n      }).catch(error => {\n        console.log(JSON.stringify(error));\n      });\n    },\n    calculateItems() {\n      // Initialize an object to store unique items\n      // const uniqueItemsMap = {};\n\n      // Iterate over receipt items to calculate unique items\n      for (let i = 0; i < this.receipt_items.length; i++) {\n        let item = {};\n        item.source_id = this.receipt_items[i].source_id;\n        item.name = this.receipt_items[i].name;\n        item.quantity = this.receipt_items[i].quantity;\n        item.gross_amount = this.receipt_items[i].gross_amount;\n        this.unique_items.push(item);\n      }\n\n      // this.receipt_items.forEach(item => {\n      //     const { source_id, name, quantity, gross_amount } = item;\n\n      //     if (uniqueItemsMap[source_id]) {\n      //         // If item exists, update quantity and gross_value\n      //         uniqueItemsMap[source_id].name = name;\n      //         uniqueItemsMap[source_id].quantity += quantity;\n      //         uniqueItemsMap[source_id].gross_amount += gross_amount;\n      //     } else {\n      //         // If item does not exist, create new entry\n      //         uniqueItemsMap[source_id] = {\n      //             source_id,\n      //             name,\n      //             quantity,\n      //             gross_amount\n      //         };\n      //     }\n      // });\n\n      // // Convert object to array of unique items\n      // this.unique_items = Object.values(uniqueItemsMap);\n    },\n    async dateChange() {\n      await this.getReceiptItems();\n      await this.calculateItems;\n    },\n    setWeekRange() {\n      const currentDate = new Date();\n      const firstDayOfWeek = new Date(currentDate.setDate(currentDate.getDate() - currentDate.getDay() + 1));\n      const lastDayOfWeek = new Date(currentDate.setDate(currentDate.getDate() - currentDate.getDay() + 7));\n\n      // Format dates as YYYY-MM-DD strings\n      const formattedFirstDay = firstDayOfWeek.toISOString().split('T')[0];\n      const formattedLastDay = lastDayOfWeek.toISOString().split('T')[0];\n\n      // Set the data properties\n      this.dateFrom = formattedFirstDay;\n      this.dateTo = formattedLastDay;\n    }\n  }\n};","map":{"version":3,"names":["axios","toast","name","data","dateFrom","dateTo","receipt_items","unique_items","mounted","getReceiptItems","setWeekRange","methods","get","then","response","console","log","i","length","date","x","push","calculateItems","catch","error","JSON","stringify","item","source_id","quantity","gross_amount","dateChange","currentDate","Date","firstDayOfWeek","setDate","getDate","getDay","lastDayOfWeek","formattedFirstDay","toISOString","split","formattedLastDay"],"sources":["/Users/danielkusmider/Library/CloudStorage/OneDrive-Personal/Docs/Projects/ScrapYard/scrap_yard_vue/src/views/dashboard/ItemStatistics.vue"],"sourcesContent":["<template>\n    <div class=\"page-items-stats\">\n        <nav class=\"breadcrumb\" aria-label=\"breadcrumbs\">\n            <ul>\n                <li><router-link to=\"/dashboard\">Dashboard</router-link></li>\n                <li><router-link to=\"/dashboard/items\">Produkty</router-link></li>\n                <li class=\"is-active\"><router-link to=\"/dashboard/items/stats\" aria-current=\"true\">Statystyki produktów</router-link></li>\n            </ul>\n        </nav>\n\n        <div class=\"columns is-multiline\">\n            <div class=\"column is-12\">\n                <h1 class=\"title\">Statystyki produktów</h1>\n\n                <div class=\"column is-3\">\n                    <div class=\"field\">\n                        <label>Zakres od:</label>\n\n                        <div class=\"control\">\n                            <input type=\"date\" name=\"receipt_date\" class=\"input\" v-model=\"dateFrom\" @change=\"dateChange\">\n                        </div>\n                    </div>\n                    <div class=\"field\">\n                        <label>Zakres do:</label>\n\n                        <div class=\"control\">\n                            <input type=\"date\" name=\"receipt_date\" class=\"input\" v-model=\"dateTo\" @change=\"dateChange\">\n                        </div>\n                    </div>\n                </div>\n\n                <div class=\"table-container\">\n                    <table class=\"table\">\n                        <thead>\n                            <tr>\n                                <th>Produkt</th>\n                                <th>Ilość</th>\n                                <th>Wypłacona kwota</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            <tr\n                                v-for=\"item in unique_items\"\n                                v-bind:key=\"item.id\"\n                            >\n                                <td>{{ item.name }}</td>\n                                <td>{{ item.quantity }} kg</td>\n                                <td>{{ item.gross_amount }} zł</td>\n                            </tr>\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nimport axios from 'axios'\nimport { toast } from 'bulma-toast'\n\nexport default {\n    name: 'ItemStatistics',\n    data() {\n        return {\n            dateFrom: '',\n            dateTo: '',\n            receipt_items: [],\n            unique_items: []\n        }\n    },\n    mounted() {\n        this.getReceiptItems(),\n        this.setWeekRange()\n    },\n    methods: {\n        getReceiptItems() {\n            axios\n                .get('/api/v1/receipts/')\n                .then(response => {\n                    console.log(response)\n                    for (let i = 0; i < response.data.length; i++) {\n                        if (response.data[i].date >= this.dateFrom && response.data[i].date <= this.dateTo) {\n                            for (let x = 0; x < response.data[i].receipt_items.length; x++) {\n                                this.receipt_items.push(response.data[i].receipt_items[x])\n                            }\n                        }\n                    }\n                    this.calculateItems()\n                })\n                .catch(error => {\n                    console.log(JSON.stringify(error))\n                })\n        },\n        calculateItems() {\n            // Initialize an object to store unique items\n            // const uniqueItemsMap = {};\n            \n            // Iterate over receipt items to calculate unique items\n            for (let i = 0; i < this.receipt_items.length; i++) {\n                let item = {}\n                item.source_id = this.receipt_items[i].source_id\n                item.name = this.receipt_items[i].name\n                item.quantity = this.receipt_items[i].quantity\n                item.gross_amount = this.receipt_items[i].gross_amount\n\n                this.unique_items.push(item)\n            }\n\n\n\n            // this.receipt_items.forEach(item => {\n            //     const { source_id, name, quantity, gross_amount } = item;\n                \n            //     if (uniqueItemsMap[source_id]) {\n            //         // If item exists, update quantity and gross_value\n            //         uniqueItemsMap[source_id].name = name;\n            //         uniqueItemsMap[source_id].quantity += quantity;\n            //         uniqueItemsMap[source_id].gross_amount += gross_amount;\n            //     } else {\n            //         // If item does not exist, create new entry\n            //         uniqueItemsMap[source_id] = {\n            //             source_id,\n            //             name,\n            //             quantity,\n            //             gross_amount\n            //         };\n            //     }\n            // });\n            \n            // // Convert object to array of unique items\n            // this.unique_items = Object.values(uniqueItemsMap);\n        },\n        async dateChange() {\n            await this.getReceiptItems()\n            await this.calculateItems\n        },\n        setWeekRange() {\n            const currentDate = new Date();\n            const firstDayOfWeek = new Date(currentDate.setDate(currentDate.getDate() - currentDate.getDay()+1));\n            const lastDayOfWeek = new Date(currentDate.setDate(currentDate.getDate() - currentDate.getDay() + 7));\n            \n            // Format dates as YYYY-MM-DD strings\n            const formattedFirstDay = firstDayOfWeek.toISOString().split('T')[0];\n            const formattedLastDay = lastDayOfWeek.toISOString().split('T')[0];\n            \n            // Set the data properties\n            this.dateFrom = formattedFirstDay;\n            this.dateTo = formattedLastDay;\n        },\n    }\n}\n</script>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}
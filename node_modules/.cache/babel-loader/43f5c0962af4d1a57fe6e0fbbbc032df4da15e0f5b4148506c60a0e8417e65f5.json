{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport axios from 'axios';\nimport { toast } from 'bulma-toast';\nexport default {\n  name: 'Items',\n  data() {\n    return {\n      categories: [],\n      items: []\n    };\n  },\n  mounted() {\n    this.getCategories();\n    this.getItems();\n  },\n  methods: {\n    getCategories() {\n      axios.get('/api/v1/categories/').then(response => {\n        for (let i = 0; i < response.data.length; i++) {\n          this.categories.push(response.data[i]);\n        }\n      }).catch(error => {\n        console.log(JSON.stringify(error));\n      });\n    },\n    getItems() {\n      axios.get('/api/v1/items/').then(response => {\n        for (let i = 0; i < response.data.length; i++) {\n          this.items.push(response.data[i]);\n        }\n      }).catch(error => {\n        console.log(JSON.stringify(error));\n      });\n    },\n    submitForm() {\n      // Prepare data for updating buy_price and sell_price\n      const updatedItems = this.items.filter(item => item.buy_price !== undefined || item.sell_price !== undefined).map(item => ({\n        id: item.id,\n        buy_price: item.buy_price,\n        sell_price: item.sell_price\n      }));\n\n      // Update backend using Axios\n      updatedItems.forEach(item => {\n        axios.patch(`/api/v1/items/${item.id}/`, {\n          buy_price: item.buy_price,\n          sell_price: item.sell_price\n        }).then(response => {}).catch(error => {\n          console.log(JSON.stringify(error));\n        });\n      }, toast({\n        message: 'Zapisano nowe ceny produktów',\n        type: 'is-success',\n        dismissible: true,\n        pauseOnHover: true,\n        duration: 2000,\n        position: 'bottom-right'\n      }));\n    },\n    confirmDelete(item) {\n      this.selectedItemToDelete = item;\n      const confirmMessage = `Czy na pewno chcesz usunąć produkt \"${item.name}\"?`;\n      if (window.confirm(confirmMessage)) {\n        this.deleteItem();\n      }\n    },\n    deleteItem() {\n      if (!this.selectedItemToDelete) {\n        return;\n      }\n      axios.delete(`/api/v1/items/${this.selectedItemToDelete.id}/`).then(response => {\n        // Remove the deleted item from the items list\n        const index = this.items.findIndex(item => item.id === this.selectedItemToDelete.id);\n        if (index !== -1) {\n          this.items.splice(index, 1);\n        }\n        toast({\n          message: 'Produkt został usunięty',\n          type: 'is-success',\n          dismissible: true,\n          duration: 2000,\n          position: 'bottom-right'\n        });\n        this.selectedItemToDelete = null;\n      }).catch(error => {\n        console.log(JSON.stringify(error));\n        toast({\n          message: 'Wystąpił błąd podczas usuwania produktu',\n          type: 'is-danger',\n          dismissible: true,\n          duration: 2000,\n          position: 'bottom-right'\n        });\n      });\n    }\n  }\n};","map":{"version":3,"names":["axios","toast","name","data","categories","items","mounted","getCategories","getItems","methods","get","then","response","i","length","push","catch","error","console","log","JSON","stringify","submitForm","updatedItems","filter","item","buy_price","undefined","sell_price","map","id","forEach","patch","message","type","dismissible","pauseOnHover","duration","position","confirmDelete","selectedItemToDelete","confirmMessage","window","confirm","deleteItem","delete","index","findIndex","splice"],"sources":["/Users/danielkusmider/Library/CloudStorage/OneDrive-Personal/Docs/Projects/ScrapYard/scrap_yard_vue/src/views/dashboard/Items.vue"],"sourcesContent":["<template>\n    <div class=\"page-items\">\n        <nav class=\"breadcrumb\" aria-label=\"breadcrumbs\">\n            <ul>\n                <li><router-link to=\"/dashboard\">Dashboard</router-link></li>\n                <li class=\"is-active\"><router-link to=\"/dashboard/my-account\" aria-current=\"true\">Produkty</router-link></li>\n            </ul>\n        </nav>\n\n        <div class=\"columns is-multiline\">\n            <div class=\"column is-12\">\n                <h1 class=\"title\">Produkty</h1>\n\n                <div class=\"buttons\">\n                    <button class=\"button is-success\" @click=\"submitForm\">Zapisz zmiany cen</button>\n                    <router-link to=\"/dashboard/items/add-category\" class=\"button is-light\">Nowa kategoria</router-link>\n                    <router-link to=\"/dashboard/items/add-item\" class=\"button is-light\">Nowy produkt</router-link>\n                </div>\n            </div>\n        </div>\n\n        <div \n            class=\"column is-8 box\"\n            v-for=\"category in categories\"\n            v-bind:key=\"category.id\"\n        >\n            <h3 class=\"title is-4\">{{ category.name }}</h3>\n\n            <table class=\"table is-hoverable\">\n                <thead>\n                    <tr>\n                        <th><div style=\"width: 200px;\">Produkt</div></th>\n                        <th><div style=\"width: 100px;\">Kod odpadu</div></th>\n                        <th><div style=\"width: 150px;\">Cena skupu</div></th>\n                        <th><div style=\"width: 150px;\">Cena sprzedaży</div></th>\n                        <th></th>\n                        <th></th>\n                    </tr>\n                </thead>\n\n                <tbody>\n                    <tr\n                        v-for=\"item in items\"\n                        v-bind:key=\"item.id\"\n                    >\n                        <td v-if=\"item.category === category.id\">{{ item.name }}</td>\n                        <td v-if=\"item.category === category.id\"><div class=\"has-text-centered\">{{ item.item_code }}</div></td>\n                        <td v-if=\"item.category === category.id\"><input type=\"number\" step=\"0.01\" class=\"input is-small has-text-right\" size=\"4\" v-model=\"item.buy_price\"></td>\n                        <td v-if=\"item.category === category.id\"><input type=\"number\" step=\"0.01\" class=\"input is-small has-text-right\" size=\"4\" v-model=\"item.sell_price\"></td>\n                        <td v-if=\"item.category === category.id\"><router-link :to=\"{ name: 'EditItem', params: { id: item.id }}\" class=\"button is-info is-small\">Edytuj</router-link></td>\n                        <!-- <td v-if=\"item.category === category.id\"><button class=\"button is-danger is-small\" @click=\"confirmDelete(item)\">Usuń</button></td> -->\n                    </tr>\n                </tbody>\n            </table>\n\n        </div>\n    </div>\n</template>\n\n<script>\nimport axios from 'axios'\nimport { toast } from 'bulma-toast'\n\nexport default {\n    name: 'Items',\n    data() {\n        return {\n            categories: [],\n            items: []\n        }\n    },\n    mounted() {\n        this.getCategories()\n        this.getItems()\n    },\n    methods: {\n        getCategories() {\n            axios\n                .get('/api/v1/categories/')\n                .then(response => {\n                    for (let i = 0; i < response.data.length; i++) {\n                        this.categories.push(response.data[i])\n                    }\n                })\n                .catch(error => {\n                    console.log(JSON.stringify(error))\n                })\n        },\n        getItems() {\n            axios\n                .get('/api/v1/items/')\n                .then(response => {\n                    for (let i = 0; i < response.data.length; i++) {\n                        this.items.push(response.data[i])\n                    }\n                })\n                .catch(error => {\n                    console.log(JSON.stringify(error))\n                })\n        },\n        submitForm() {\n            // Prepare data for updating buy_price and sell_price\n            const updatedItems = this.items\n                .filter(item => item.buy_price !== undefined || item.sell_price !== undefined)\n                .map(\n                    item => ({\n                        id: item.id,\n                        buy_price: item.buy_price,\n                        sell_price: item.sell_price\n                    })\n                )\n\n            // Update backend using Axios\n            updatedItems.forEach(item => {\n                axios\n                    .patch(`/api/v1/items/${item.id}/`, {\n                        buy_price: item.buy_price,\n                        sell_price: item.sell_price\n                    })\n                    .then(response => {\n                        \n                    })\n                    .catch(error => {\n                        console.log(JSON.stringify(error))\n                    })\n            },\n                toast({\n                    message: 'Zapisano nowe ceny produktów',\n                    type: 'is-success',\n                    dismissible: true,\n                    pauseOnHover: true,\n                    duration: 2000,\n                    position: 'bottom-right',\n                })\n            )\n        },\n        confirmDelete(item) {\n            this.selectedItemToDelete = item\n            const confirmMessage = `Czy na pewno chcesz usunąć produkt \"${item.name}\"?`\n\n            if (window.confirm(confirmMessage)) {\n                this.deleteItem()\n            }\n        },\n        deleteItem() {\n            if (!this.selectedItemToDelete) {\n                return\n            }\n\n            axios\n                .delete(`/api/v1/items/${this.selectedItemToDelete.id}/`)\n                .then(response => {\n                    // Remove the deleted item from the items list\n                    const index = this.items.findIndex(item => item.id === this.selectedItemToDelete.id)\n                    if (index !== -1) {\n                        this.items.splice(index, 1)\n                    }\n\n                    toast({\n                        message: 'Produkt został usunięty',\n                        type: 'is-success',\n                        dismissible: true,\n                        duration: 2000,\n                        position: 'bottom-right'\n                    })\n\n                    this.selectedItemToDelete = null\n                })\n                .catch(error => {\n                    console.log(JSON.stringify(error))\n                    toast({\n                        message: 'Wystąpił błąd podczas usuwania produktu',\n                        type: 'is-danger',\n                        dismissible: true,\n                        duration: 2000,\n                        position: 'bottom-right'\n                    })\n                })\n        }\n    }\n}\n</script>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}